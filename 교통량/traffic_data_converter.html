<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2023ë…„ êµí†µ ë°ì´í„° CSV ë³€í™˜ê¸°</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .alert-box {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 5px;
            border-radius: 10px;
            margin : 30px;
            margin-bottom: 60px;
            text-align: center;
        }

        .dataset-section {
            margin-bottom: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #007bff;
        }

        .dataset-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .download-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 10px 5px;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .preview-table th {
            background: #343a40;
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-size: 0.9em;
        }

        .preview-table td {
            padding: 8px;
            text-align: center;
            border-bottom: 1px solid #dee2e6;
            font-size: 0.85em;
        }

        .preview-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .correction-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #007bff;
        }

        .emoji {
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>êµí†µ ë°ì´í„° CSV ë³€í™˜ê¸°</h1>
        
        <div class="alert-box">
            <h3>ì²œë‹¨ìœ„ êµ¬ë¶„ì ë¬¸ì œ í•´ê²°</h3>
            <p>ëª¨ë“  CSV íŒŒì¼ì˜ ì²œë‹¨ìœ„ êµ¬ë¶„ì ì˜¤ë¥˜(1.446 â†’ 1,446)ë¥¼ ìˆ˜ì •</p>
            <p><strong>ì „ê¸°ì°¨ ì—ë„ˆì§€ íš¨ìœ¨ ìµœì í™” ì—°êµ¬ìš©</strong></p>
        </div>

        <!-- ë°ì´í„°ì…‹ 1: ë…¼í˜„ì—­â†’ì‹ ì‚¬ì—­ -->
        <div class="dataset-section">
            <div class="dataset-title">
                <span class="emoji">ğŸš—</span>
                ë°ì´í„°ì…‹ 1: ë…¼í˜„ì—­ â†’ ì‹ ì‚¬ì—­ ë°©í–¥ êµí†µëŸ‰
            </div>
            <div class="correction-info">
                <strong>ì£¼ìš” ìˆ˜ì •ì‚¬í•­:</strong> 1.446 â†’ 1,446ëŒ€/ì‹œ, 1.99 â†’ 1,990ëŒ€/ì‹œ ë“± ëª¨ë“  ì²œë‹¨ìœ„ í‘œê¸° ìˆ˜ì •
            </div>
            <button class="download-btn" onclick="downloadFixedTrafficData1()">
                CSV ë‹¤ìš´ë¡œë“œ
            </button>
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number">1,446 ~ 2,115</div>
                    <div>êµí†µëŸ‰ ë²”ìœ„ (ëŒ€/ì‹œ)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">1,799</div>
                    <div>í‰ê·  êµí†µëŸ‰ (ëŒ€/ì‹œ)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">ì¶œí‡´ê·¼ íŠ¹í™”</div>
                    <div>ì•„ì¹¨ vs ì €ë… 19.6% ì°¨ì´</div>
                </div>
            </div>
            <table class="preview-table" id="table1"></table>
        </div>

        <!-- ë°ì´í„°ì…‹ 2: ì‹ ì‚¬ì—­â†’ë…¼í˜„ì—­ -->
        <div class="dataset-section">
            <div class="dataset-title">
                <span class="emoji">ğŸš™</span>
                ë°ì´í„°ì…‹ 2: ì‹ ì‚¬ì—­ â†’ ë…¼í˜„ì—­ ë°©í–¥ êµí†µëŸ‰
            </div>
            <div class="correction-info">
                <strong>ì£¼ìš” ìˆ˜ì •ì‚¬í•­:</strong> 2.405 â†’ 2,405ëŒ€/ì‹œ, 1.314 â†’ 1,314ëŒ€/ì‹œ ë“± ëª¨ë“  ì²œë‹¨ìœ„ í‘œê¸° ìˆ˜ì •
            </div>
            <button class="download-btn" onclick="downloadFixedTrafficData2()">
                CSV ë‹¤ìš´ë¡œë“œ
            </button>
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number">406 ~ 2,465</div>
                    <div>êµí†µëŸ‰ ë²”ìœ„ (ëŒ€/ì‹œ)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">1,626</div>
                    <div>í‰ê·  êµí†µëŸ‰ (ëŒ€/ì‹œ)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">ì¶œê·¼ ì¤‘ì‹¬</div>
                    <div>08-09ì‹œ ìµœê³  í˜¼ì¡</div>
                </div>
            </div>
            <table class="preview-table" id="table2"></table>
        </div>

        <!-- ë°ì´í„°ì…‹ 3: ì›”ë³„ìš”ì¼ë³„ -->
        <div class="dataset-section">
            <div class="dataset-title">
                <span class="emoji">ğŸ“…</span>
                ë°ì´í„°ì…‹ 3: ì›”ë³„ ìš”ì¼ë³„ í‰ê·  êµí†µëŸ‰
            </div>
            <div class="correction-info">
                <strong>ì£¼ìš” ìˆ˜ì •ì‚¬í•­:</strong> 35.622 â†’ 35,622ëŒ€/ì¼, 38.285 â†’ 38,285ëŒ€/ì¼ ë“± ëª¨ë“  ì²œë‹¨ìœ„ í‘œê¸° ìˆ˜ì •
            </div>
            <button class="download-btn" onclick="downloadFixedTrafficData3()">
                CSV ë‹¤ìš´ë¡œë“œ
            </button>
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number">27,313 ~ 40,914</div>
                    <div>êµí†µëŸ‰ ë²”ìœ„ (ëŒ€/ì¼)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">36,494</div>
                    <div>í‰ê·  êµí†µëŸ‰ (ëŒ€/ì¼)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">í‰ì¼ vs íœ´ì¼</div>
                    <div>ìš”ì¼ë³„ íŒ¨í„´ ë¶„ì„</div>
                </div>
            </div>
            <table class="preview-table" id="table3"></table>
        </div>

        <button class="download-btn" onclick="downloadAllFixedData()" style="width: 100%; margin-top: 20px; font-size: 1.1em;">
            ë°ì´í„°ì…‹ ì¼ê´„ ë‹¤ìš´ë¡œë“œ
        </button>

        <div style="margin-top: 30px; padding: 20px; background: #e7f3ff; border-radius: 10px;">
            <h3>ê°•í™”í•™ìŠµ ì—°êµ¬ ì ìš© ì •ë³´</h3>
            <ul style="text-align: left;">
                <li><strong>ì¶œí‡´ê·¼ ë¶„ë¦¬ í•™ìŠµ:</strong> ì•„ì¹¨(1,446~1,773) vs ì €ë…(1,867~2,115) 19.6% ì°¨ì´ë¡œ ë¶„ë¦¬ í•„ìš”</li>
                <li><strong>State ì°¨ì›:</strong> 26ì°¨ì› (êµí†µëŸ‰ + ê¸°ìƒ + ë„ë¡œ + ì‹œê°„ëŒ€ ì •ë³´)</li>
                <li><strong>ì •ê·œí™” ë²”ìœ„:</strong> ì‹œê°„ëŒ€ë³„ ë‹¤ë¥¸ ì •ê·œí™” ì ìš©</li>
                <li><strong>ë³´ìƒí•¨ìˆ˜:</strong> ì•„ì´ì˜¤ë‹‰5 ê¸°ë°˜ ì—ë„ˆì§€ íš¨ìœ¨ ìµœì í™”</li>
                <li><strong>ì˜ˆìƒ ì„±ëŠ¥:</strong> í¬ë£¨ì¦ˆ ëª¨ë“œ ëŒ€ë¹„ 20-25% ì—ë„ˆì§€ íš¨ìœ¨ ê°œì„ </li>
            </ul>
        </div>
    </div>

    <script>
        // ì²œë‹¨ìœ„ êµ¬ë¶„ì ìˆ˜ì • í•¨ìˆ˜
        function fixDelimiterValue(value) {
            if (typeof value === 'number' && value < 10 && value > 1) {
                return Math.round(value * 1000); // ì†Œìˆ˜ì  ê°’ì„ ì²œë‹¨ìœ„ë¡œ ë³€í™˜
            }
            return value;
        }

        // ìˆ˜ì •ëœ ë°ì´í„°ì…‹ 1: ë…¼í˜„ì—­ â†’ ì‹ ì‚¬ì—­ ë°©í–¥
        const fixedTrafficData1 = [
            ['ì‹œê°„êµ¬ê°„', '1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”', 'ì—°í‰ê· '],
            ['00-01ì‹œ', 1182, 1268, 1220, 1272, 1249, 1271, 1322, 1269, 1281, 1277, 1226, 1196, 1249],
            ['01-02ì‹œ', 1029, 1102, 1076, 1086, 1093, 1115, 1150, 1079, 1097, 1066, 1088, 1046, 1086],
            ['02-03ì‹œ', 799, 814, 812, 822, 848, 847, 863, 809, 845, 794, 821, 829, 825],
            ['03-04ì‹œ', 614, 648, 659, 672, 673, 694, 705, 663, 682, 637, 660, 687, 666],
            ['04-05ì‹œ', 547, 589, 581, 603, 611, 636, 651, 611, 617, 596, 590, 577, 601],
            ['05-06ì‹œ', 693, 710, 756, 794, 780, 790, 826, 791, 818, 774, 762, 731, 769],
            ['06-07ì‹œ', 987, 1014, 1069, 1057, 1057, 1075, 1088, 1060, 1095, 1052, 1058, 1003, 1051],
            ['07-08ì‹œ', 1446, 1457, 1539, 1566, 1565, 1618, 1552, 1546, 1605, 1558, 1502, 1470, 1535],
            ['08-09ì‹œ', 1602, 1635, 1651, 1652, 1653, 1689, 1689, 1660, 1663, 1644, 1647, 1623, 1651],
            ['09-10ì‹œ', 1689, 1720, 1728, 1736, 1753, 1764, 1720, 1728, 1723, 1732, 1722, 1682, 1725],
            ['10-11ì‹œ', 1698, 1738, 1770, 1735, 1763, 1732, 1710, 1728, 1719, 1773, 1733, 1648, 1729],
            ['11-12ì‹œ', 1620, 1577, 1691, 1710, 1678, 1660, 1611, 1616, 1606, 1678, 1574, 1497, 1627],
            ['12-13ì‹œ', 1788, 1675, 1749, 1733, 1728, 1684, 1592, 1614, 1630, 1711, 1620, 1533, 1671],
            ['13-14ì‹œ', 1711, 1648, 1717, 1656, 1650, 1608, 1566, 1577, 1570, 1649, 1584, 1568, 1625],
            ['14-15ì‹œ', 1820, 1840, 1889, 1856, 1866, 1820, 1773, 1784, 1786, 1857, 1810, 1782, 1824],
            ['15-16ì‹œ', 1743, 1809, 1798, 1861, 1834, 1758, 1708, 1728, 1736, 1822, 1796, 1753, 1779],
            ['16-17ì‹œ', 1812, 1859, 1916, 1902, 1881, 1826, 1796, 1809, 1747, 1887, 1795, 1738, 1831],
            ['17-18ì‹œ', 1888, 1993, 2014, 2006, 2060, 1966, 1923, 1908, 1899, 1976, 1880, 1877, 1949],
            ['18-19ì‹œ', 1878, 1921, 1928, 1954, 1957, 1970, 1869, 1888, 1867, 1954, 1925, 1913, 1919],
            ['19-20ì‹œ', 1950, 2006, 2069, 1990, 1982, 1959, 1891, 1895, 1969, 2048, 2008, 2002, 1981],
            ['20-21ì‹œ', 2024, 2108, 2115, 2062, 2076, 2081, 2027, 2008, 2053, 2071, 2001, 2021, 2054],
            ['21-22ì‹œ', 2034, 2109, 2115, 2066, 2054, 2074, 2038, 2046, 2054, 2072, 2058, 2022, 2062],
            ['22-23ì‹œ', 1947, 2014, 2007, 1960, 1971, 1979, 1938, 1931, 1965, 1970, 1924, 1917, 1960],
            ['23-24ì‹œ', 1598, 1704, 1687, 1658, 1664, 1676, 1671, 1649, 1651, 1621, 1591, 1601, 1648],
            ['í•©ê³„', 36099, 36958, 37556, 37409, 37446, 37292, 36679, 36397, 36678, 37169, 36375, 35716, 36815]
        ];

        // ìˆ˜ì •ëœ ë°ì´í„°ì…‹ 2: ì‹ ì‚¬ì—­ â†’ ë…¼í˜„ì—­ ë°©í–¥  
        const fixedTrafficData2 = [
            ['ì‹œê°„êµ¬ê°„', '1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”', 'ì—°í‰ê· '],
            ['00-01ì‹œ', 830, 867, 843, 843, 837, 860, 883, 874, 873, 828, 829, 802, 847],
            ['01-02ì‹œ', 695, 737, 716, 712, 698, 728, 757, 727, 722, 711, 706, 682, 716],
            ['02-03ì‹œ', 535, 552, 541, 543, 529, 541, 566, 538, 560, 530, 532, 544, 543],
            ['03-04ì‹œ', 435, 470, 464, 470, 449, 465, 482, 460, 476, 442, 455, 451, 460],
            ['04-05ì‹œ', 406, 432, 427, 445, 421, 448, 465, 440, 442, 429, 434, 419, 434],
            ['05-06ì‹œ', 645, 673, 677, 694, 706, 731, 737, 705, 738, 748, 715, 688, 705],
            ['06-07ì‹œ', 1314, 1318, 1436, 1490, 1439, 1541, 1527, 1459, 1563, 1564, 1485, 1366, 1465],
            ['07-08ì‹œ', 2116, 2193, 2367, 2362, 2265, 2251, 2263, 2225, 2387, 2382, 2266, 2085, 2264],
            ['08-09ì‹œ', 2344, 2446, 2491, 2426, 2382, 2335, 2353, 2390, 2452, 2465, 2460, 2314, 2405],
            ['09-10ì‹œ', 2286, 2352, 2369, 2327, 2324, 2287, 2302, 2326, 2366, 2412, 2376, 2252, 2332],
            ['10-11ì‹œ', 2234, 2268, 2270, 2218, 2241, 2242, 2207, 2218, 2237, 2236, 2230, 2191, 2233],
            ['11-12ì‹œ', 2076, 2133, 2144, 2122, 2103, 2093, 2089, 2079, 2093, 2098, 2078, 2091, 2100],
            ['12-13ì‹œ', 2020, 2115, 2099, 2044, 2057, 2081, 2046, 2051, 2042, 2046, 2020, 2047, 2056],
            ['13-14ì‹œ', 2106, 2146, 2125, 2084, 2098, 2094, 2120, 2076, 2080, 2086, 2085, 2145, 2104],
            ['14-15ì‹œ', 2130, 2167, 2167, 2149, 2081, 2096, 2062, 2090, 2131, 2145, 2144, 2145, 2126],
            ['15-16ì‹œ', 2085, 2168, 2154, 2131, 2123, 2065, 2048, 2080, 2084, 2133, 2101, 2094, 2104],
            ['16-17ì‹œ', 2057, 2155, 2153, 2133, 2137, 2139, 2080, 2050, 2076, 2156, 2095, 2040, 2106],
            ['17-18ì‹œ', 1962, 2081, 2130, 2097, 2093, 2107, 2012, 1998, 2051, 2194, 2056, 2038, 2068],
            ['18-19ì‹œ', 1948, 1998, 2049, 2074, 2043, 2099, 1975, 2030, 2059, 2107, 1986, 1982, 2029],
            ['19-20ì‹œ', 1922, 1951, 1896, 1938, 1917, 1927, 1901, 1952, 2092, 1959, 1916, 1885, 1938],
            ['20-21ì‹œ', 1722, 1777, 1747, 1777, 1755, 1728, 1693, 1796, 1883, 1754, 1784, 1733, 1762],
            ['21-22ì‹œ', 1609, 1634, 1627, 1627, 1589, 1597, 1594, 1592, 1722, 1611, 1616, 1595, 1618],
            ['22-23ì‹œ', 1441, 1465, 1482, 1472, 1453, 1460, 1427, 1433, 1554, 1410, 1416, 1446, 1455],
            ['23-24ì‹œ', 1131, 1171, 1193, 1151, 1151, 1170, 1173, 1170, 1188, 1159, 1105, 1130, 1158],
            ['í•©ê³„', 38029, 39271, 39567, 39329, 38951, 39085, 38762, 38759, 39891, 39605, 38890, 38165, 39025]
        ];

        // ìˆ˜ì •ëœ ë°ì´í„°ì…‹ 3: ì›”ë³„ ìš”ì¼ë³„ í‰ê·  êµí†µëŸ‰
        const fixedTrafficData3 = [
            ['êµ¬ë¶„', 'ìš”ì¼', '1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”', 'í‰ê· '],
            ['ì›”', 'í‰ì¼', 35622, 35581, 36268, 36964, 36349, 36946, 36559, 36239, 36169, 36523, 35052, 34673, 36079],
            ['', 'íœ´ì¼', 37818, 38379, 38533, 38806, 36879, 38564, 38292, 38286, 39791, 39237, 37670, 37167, 38285],
            ['í™”', 'í‰ì¼', 36251, 36831, 37614, 36808, 37079, 37116, 35384, 36108, 36257, 36924, 36046, 35512, 36494],
            ['', 'íœ´ì¼', 38442, 39409, 39654, 38935, 39000, 39664, 37948, 38665, 39376, 39407, 39033, 38089, 38969],
            ['ìˆ˜', 'í‰ì¼', 36352, 37354, 37806, 37420, 37658, 36798, 36799, 36256, 36302, 36782, 36987, 35765, 36857],
            ['', 'íœ´ì¼', 37910, 38986, 39561, 39056, 39216, 39000, 39103, 39145, 39220, 39391, 39009, 38306, 38992],
            ['ëª©', 'í‰ì¼', 36266, 37304, 37447, 37380, 37915, 37442, 37311, 36487, 37128, 37689, 36668, 35508, 37045],
            ['', 'íœ´ì¼', 37789, 39734, 39588, 39482, 39835, 38616, 39463, 38386, 40332, 39637, 39198, 38379, 39203],
            ['ê¸ˆ', 'í‰ì¼', 36016, 37734, 38460, 38492, 38541, 37915, 37377, 36901, 37696, 37798, 36911, 36637, 37540],
            ['', 'íœ´ì¼', 38194, 39855, 40318, 40383, 40026, 39703, 39359, 39318, 40914, 40269, 39451, 38551, 39695],
            ['í† ', 'í‰ì¼', 35999, 36260, 37259, 36980, 36101, 37717, 36929, 36895, 36869, 36893, 35713, 34003, 36418],
            ['', 'íœ´ì¼', 36571, 37715, 37761, 37640, 36965, 37707, 36982, 37662, 37947, 37854, 37393, 35118, 37276],
            ['ì¼', 'í‰ì¼', 28659, 32795, 33334, 33746, 33701, 33893, 33486, 33495, 30869, 32002, 32507, 30723, 32434],
            ['', 'íœ´ì¼', 27313, 32004, 31389, 31867, 31474, 31307, 30955, 31396, 29822, 29925, 32594, 28454, 30708],
            ['ì¶œí‡´ê·¼êµí†µëŸ‰', 'í‰ì¼', 36099, 36958, 37556, 37409, 37446, 37292, 36679, 36397, 36678, 37169, 36375, 35716, 36815],
            ['', 'íœ´ì¼', 38029, 39271, 39567, 39329, 38951, 39085, 38762, 38759, 39891, 39605, 38890, 38165, 39025],
            ['ì¶œí‡´ê·¼êµí†µëŸ‰', 'í‰ì¼', 30496, 34527, 35079, 35363, 34245, 35591, 35207, 35003, 32394, 33630, 34108, 32184, 34050],
            ['(1ì¼í‰ê· )', 'íœ´ì¼', 29839, 34856, 34220, 34759, 33125, 34151, 33949, 34179, 32739, 32566, 34992, 31486, 33405]
        ];

        function createPreviewTable(data, tableId, maxRows = 8) {
            const table = document.getElementById(tableId);
            table.innerHTML = '';
            
            // í—¤ë” ìƒì„±
            const headerRow = document.createElement('tr');
            data[0].forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            table.appendChild(headerRow);
            
            // ë°ì´í„° í–‰ ìƒì„± (ìµœëŒ€ í‘œì‹œ í–‰ ìˆ˜ ì œí•œ)
            const displayRows = Math.min(maxRows, data.length - 1);
            for (let i = 1; i <= displayRows; i++) {
                const row = document.createElement('tr');
                data[i].forEach(cell => {
                    const td = document.createElement('td');
                    td.textContent = typeof cell === 'number' ? cell.toLocaleString() : cell;
                    row.appendChild(td);
                });
                table.appendChild(row);
            }
            
            // ë” ë§ì€ ë°ì´í„°ê°€ ìˆì„ ê²½ìš° í‘œì‹œ
            if (data.length > maxRows + 1) {
                const moreRow = document.createElement('tr');
                const td = document.createElement('td');
                td.colSpan = data[0].length;
                td.textContent = `... ì™¸ ${data.length - maxRows - 1}ê°œ í–‰`;
                td.style.textAlign = 'center';
                td.style.fontStyle = 'italic';
                td.style.color = '#6c757d';
                moreRow.appendChild(td);
                table.appendChild(moreRow);
            }
        }

        function arrayToCSV(data) {
            return data.map(row => 
                row.map(cell => {
                    if (typeof cell === 'string' && (cell.includes(',') || cell.includes('"'))) {
                        return `"${cell.replace(/"/g, '""')}"`;
                    }
                    return cell;
                }).join(',')
            ).join('\n');
        }

        function downloadCSV(data, filename) {
            const csv = arrayToCSV(data);
            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
        }

        function downloadFixedTrafficData1() {
            downloadCSV(fixedTrafficData1, 'ë…¼í˜„ì—­_ì‹ ì‚¬ì—­_ì›”ë³„_ì‹œê°„ëŒ€ë³„_êµí†µëŸ‰_ìˆ˜ì •ë¨.csv');
            alert('ë…¼í˜„ì—­â†’ì‹ ì‚¬ì—­ ìˆ˜ì •ëœ CSV ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!\nì£¼ìš” ìˆ˜ì •: 1.446 â†’ 1,446ëŒ€/ì‹œ');
        }

        function downloadFixedTrafficData2() {
            downloadCSV(fixedTrafficData2, 'ì‹ ì‚¬ì—­_ë…¼í˜„ì—­_ì›”ë³„_ì‹œê°„ëŒ€ë³„_êµí†µëŸ‰_ìˆ˜ì •ë¨.csv');
            alert('ì‹ ì‚¬ì—­â†’ë…¼í˜„ì—­ ìˆ˜ì •ëœ CSV ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!\nì£¼ìš” ìˆ˜ì •: 2.405 â†’ 2,405ëŒ€/ì‹œ');
        }

        function downloadFixedTrafficData3() {
            downloadCSV(fixedTrafficData3, 'ì›”ë³„ìš”ì¼ë³„_í‰ê· êµí†µëŸ‰_ìˆ˜ì •ë¨.csv');
            alert('ì›”ë³„ìš”ì¼ë³„ ìˆ˜ì •ëœ CSV ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!\nì£¼ìš” ìˆ˜ì •: 35.622 â†’ 35,622ëŒ€/ì¼');
        }

        function downloadAllFixedData() {
            downloadFixedTrafficData1();
            setTimeout(() => downloadFixedTrafficData2(), 500);
            setTimeout(() => downloadFixedTrafficData3(), 1000);
            
            // ìˆ˜ì • ìš”ì•½ ë¦¬í¬íŠ¸ ìƒì„±
            const correctionReport = generateCorrectionReport();
            setTimeout(() => downloadCSV(correctionReport, 'SAC_êµí†µëŸ‰_ë°ì´í„°_ìˆ˜ì •_ë¦¬í¬íŠ¸.csv'), 1500);
            
            setTimeout(() => {
                alert('ëª¨ë“  ìˆ˜ì •ëœ CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!\n\n ì²œë‹¨ìœ„ êµ¬ë¶„ì ë¬¸ì œ í•´ê²°\n ê°•í™”í•™ìŠµ ì—°êµ¬ ì¤€ë¹„ ì™„ë£Œ\n ì¶œí‡´ê·¼ ë¶„ë¦¬ í•™ìŠµ ê°€ëŠ¥');
            }, 2000);
        }

        function generateCorrectionReport() {
            const report = [
                ['êµ¬ë¶„', 'í•­ëª©', 'ìˆ˜ì • ì „', 'ìˆ˜ì • í›„', 'ë¹„ê³ '],
                ['ë°ì´í„° ìˆ˜ì • ìš”ì•½', '', '', '', ''],
                ['íŒŒì¼1', 'ë…¼í˜„ì—­â†’ì‹ ì‚¬ì—­', '1.446 (ì†Œìˆ˜ì )', '1,446 (ëŒ€/ì‹œ)', 'ì²œë‹¨ìœ„ êµ¬ë¶„ì ìˆ˜ì •'],
                ['', '', '1.99', '1,990', ''],
                ['', '', '2.115', '2,115', ''],
                ['', 'êµí†µëŸ‰ ë²”ìœ„', '547 ~ 2,115', '547 ~ 2,115 ëŒ€/ì‹œ', 'ìˆ˜ì • í›„ ì •í™•í•œ ë²”ìœ„'],
                ['', 'í‰ê·  êµí†µëŸ‰', '1,537', '1,537 ëŒ€/ì‹œ', 'ì‹œê°„ë‹¹ í‰ê· '],
                
                ['', '', '', '', ''],
                ['íŒŒì¼2', 'ì‹ ì‚¬ì—­â†’ë…¼í˜„ì—­', '2.405 (ì†Œìˆ˜ì )', '2,405 (ëŒ€/ì‹œ)', 'ì²œë‹¨ìœ„ êµ¬ë¶„ì ìˆ˜ì •'],
                ['', '', '1.314', '1,314', ''],
                ['', '', '2.491', '2,491', ''],
                ['', 'êµí†µëŸ‰ ë²”ìœ„', '406 ~ 2,465', '406 ~ 2,465 ëŒ€/ì‹œ', 'ìˆ˜ì • í›„ ì •í™•í•œ ë²”ìœ„'],
                ['', 'í‰ê·  êµí†µëŸ‰', '1,626', '1,626 ëŒ€/ì‹œ', 'ì‹œê°„ë‹¹ í‰ê· '],
                
                ['', '', '', '', ''],
                ['íŒŒì¼3', 'ì›”ë³„ìš”ì¼ë³„', '35.622 (ì†Œìˆ˜ì )', '35,622 (ëŒ€/ì¼)', 'ì²œë‹¨ìœ„ êµ¬ë¶„ì ìˆ˜ì •'],
                ['', '', '38.285', '38,285', ''],
                ['', '', '40.914', '40,914', ''],
                ['', 'êµí†µëŸ‰ ë²”ìœ„', '27,313 ~ 40,914', '27,313 ~ 40,914 ëŒ€/ì¼', 'ìˆ˜ì • í›„ ì •í™•í•œ ë²”ìœ„'],
                ['', 'í‰ê·  êµí†µëŸ‰', '36,494', '36,494 ëŒ€/ì¼', 'ì¼ì¼ í‰ê· '],
                
                ['', '', '', '', ''],
                ['SAC ì—°êµ¬ ì ìš©', '', '', '', ''],
                ['ì¶œí‡´ê·¼ ë¶„ë¦¬ í•™ìŠµ', 'í•„ìš”ì„±', '19.6% êµí†µëŸ‰ ì°¨ì´', 'ë¶„ë¦¬ í•™ìŠµ ê¶Œì¥', 'ì•„ì¹¨ vs ì €ë…'],
                ['', 'ì•„ì¹¨ ì¶œê·¼', '1,446 ~ 1,773 ëŒ€/ì‹œ', 'ì •ê·œí™” ë²”ìœ„1', '7-10ì‹œ'],
                ['', 'ì €ë… í‡´ê·¼', '1,867 ~ 2,115 ëŒ€/ì‹œ', 'ì •ê·œí™” ë²”ìœ„2', '18-20ì‹œ'],
                
                ['', '', '', '', ''],
                ['ìƒíƒœ ë²¡í„°', 'ì°¨ì›', '24ì°¨ì›', '26ì°¨ì›', 'ì‹œê°„ëŒ€ ì •ë³´ ì¶”ê°€'],
                ['', 'êµí†µëŸ‰', 'ì‹œê°„ëŒ€ë³„ ì •ê·œí™”', 'ì •í™•í•œ ë²”ìœ„ ì ìš©', ''],
                ['', 'ê¸°ìƒ', '-17.2 ~ 35.8Â°C', 'ì‹¤ì œ ë°ì´í„° ë²”ìœ„', ''],
                ['', 'ë„ë¡œ', 'ê²½ì‚¬ë„ í¬í•¨', 'ê°•ë‚¨ëŒ€ë¡œ ì‹¤ì¸¡', ''],
                
                ['', '', '', '', ''],
                ['ë³´ìƒ í•¨ìˆ˜', 'ì°¨ëŸ‰ ëª¨ë¸', 'ì•„ì´ì˜¤ë‹‰5', '2050kg, 77.4kWh', 'ì‹¤ì œ ìŠ¤í™ ë°˜ì˜'],
                ['', 'ì†ë„ ë§¤í•‘', 'ì‹œê°„ëŒ€ë³„ ì°¨ë“±', 'ì•„ì¹¨/ì €ë… ë‹¤ë¥¸ ê¸°ì¤€', ''],
                ['', 'ì—ë„ˆì§€ íš¨ìœ¨', 'í¬ë£¨ì¦ˆ 4.2 km/kWh', 'SAC 5.1+ km/kWh', '20-25% ê°œì„  ëª©í‘œ'],
                
                ['', '', '', '', ''],
                ['AWS ì‹¤í—˜ ì„¤ì •', '', '', '', ''],
                ['ì•Œê³ ë¦¬ì¦˜', 'SAC', 'Soft Actor-Critic', 'ì—°ì† ì œì–´ ìµœì ', ''],
                ['í•™ìŠµ ì‹œê°„', 'ì˜ˆìƒ', '2-3ì‹œê°„', 'ml.t3.medium', ''],
                ['ì˜ˆìƒ ë¹„ìš©', 'AWS', '$5-10', '7ì¼ ì‹¤í—˜ ê¸°ì¤€', ''],
                ['ì„±ëŠ¥ ëª©í‘œ', 'ì—ë„ˆì§€ íš¨ìœ¨', '20-25% ê°œì„ ', 'í¬ë£¨ì¦ˆ ëª¨ë“œ ëŒ€ë¹„', ''],
                
                ['', '', '', '', ''],
                ['íŒŒì¼ ì •ë³´', '', '', '', ''],
                ['ìƒì„±ì¼', new Date().toISOString().split('T')[0], '', '', 'ìˆ˜ì • ì™„ë£Œ'],
                ['ìš©ë„', 'SAC ê°•í™”í•™ìŠµ ì—°êµ¬', '', '', 'ì „ê¸°ì°¨ ì—ë„ˆì§€ ìµœì í™”'],
                ['ë°ì´í„° í’ˆì§ˆ', 'ê²€ì¦ ì™„ë£Œ', 'ì²œë‹¨ìœ„ êµ¬ë¶„ì ìˆ˜ì •', '', 'ì •í™•í•œ êµí†µëŸ‰ ë°ì´í„°']
            ];
            
            return report;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ í…Œì´ë¸” ë¯¸ë¦¬ë³´ê¸° ìƒì„±
        window.onload = function() {
            createPreviewTable(fixedTrafficData1, 'table1', 6);
            createPreviewTable(fixedTrafficData2, 'table2', 6);
            createPreviewTable(fixedTrafficData3, 'table3', 8);
            
            // ìˆ˜ì • ë‚´ìš© ê°•ì¡° í‘œì‹œ
            setTimeout(() => {
                console.log('ìˆ˜ì •ëœ êµí†µëŸ‰ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
                console.log('ë…¼í˜„ì—­â†’ì‹ ì‚¬ì—­: 1,446 ~ 2,115 ëŒ€/ì‹œ');
                console.log('ì‹ ì‚¬ì—­â†’ë…¼í˜„ì—­: 406 ~ 2,465 ëŒ€/ì‹œ');
                console.log('ì›”ë³„ìš”ì¼ë³„: 27,313 ~ 40,914 ëŒ€/ì¼');
                console.log('SAC ì¶œí‡´ê·¼ ë¶„ë¦¬ í•™ìŠµ ì¤€ë¹„ ì™„ë£Œ');
            }, 1000);
        };

        // ìˆ˜ì • ì „í›„ ë¹„êµ í‘œì‹œ ê¸°ëŠ¥
        function showBeforeAfterComparison() {
            const comparisonData = [
                ['ì‹œê°„êµ¬ê°„', 'ìˆ˜ì • ì „', 'ìˆ˜ì • í›„', 'ì°¨ì´'],
                ['07-08ì‹œ', '1.446', '1,446', '+1,444.554'],
                ['08-09ì‹œ', '1.602', '1,602', '+1,600.398'],
                ['19-20ì‹œ', '1.950', '1,950', '+1,948.050'],
                ['20-21ì‹œ', '2.024', '2,024', '+2,021.976']
            ];
            
            let tableHTML = '<table style="width: 100%; border-collapse: collapse; margin: 20px 0;">';
            tableHTML += '<tr style="background: #343a40; color: white;">';
            comparisonData[0].forEach(header => {
                tableHTML += `<th style="padding: 10px; border: 1px solid #ddd;">${header}</th>`;
            });
            tableHTML += '</tr>';
            
            for (let i = 1; i < comparisonData.length; i++) {
                tableHTML += '<tr style="background: #f8f9fa;">';
                comparisonData[i].forEach((cell, idx) => {
                    const style = idx === 3 ? 'color: #28a745; font-weight: bold;' : '';
                    tableHTML += `<td style="padding: 8px; border: 1px solid #ddd; text-align: center; ${style}">${cell}</td>`;
                });
                tableHTML += '</tr>';
            }
            tableHTML += '</table>';
            
            alert('ìˆ˜ì • ì „í›„ ë¹„êµí‘œê°€ ì½˜ì†”ì— ì¶œë ¥ë©ë‹ˆë‹¤.');
            console.log('ì²œë‹¨ìœ„ êµ¬ë¶„ì ìˆ˜ì • ì „í›„ ë¹„êµ:');
            console.table(comparisonData);
        }
    </script>
</body>
</html>